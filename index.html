<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üåæ DNX FARM ULTRA++</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root{--gold:#ffd700;--neon:#00ffd5}
*{box-sizing:border-box;margin:0;padding:0}
html,body{
 height:100%;overflow-x:hidden;
 font-family:"Poppins","Noto Sans Thai",sans-serif;
 background:radial-gradient(circle at top,#000 40%,#111 100%);
 color:#fff;
}
header{position:fixed;top:0;left:0;right:0;z-index:20;
display:grid;grid-template-columns:1fr auto 1fr;align-items:center;
gap:8px;padding:10px 12px;
background:linear-gradient(90deg,#111,#222,#111);
border-bottom:2px solid var(--gold);box-shadow:0 0 20px rgba(255,215,0,.3)}
button{border:none;font-weight:700;cursor:pointer;transition:transform .12s ease}
button:hover{transform:translateY(-1px)}
#langToggle{background:rgba(0,0,0,.6);border:1px solid var(--gold);color:var(--gold);padding:8px 14px;border-radius:12px}
#claimFreeTop{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000;padding:8px 14px;border-radius:18px;font-size:13px;box-shadow:0 0 10px rgba(0,255,213,.35)}
#connectBtn{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000;padding:10px 18px;border-radius:18px}
.divider{margin-top:52px;border:0;height:1px;background:linear-gradient(90deg,transparent,var(--gold),transparent)}
#refreshSmall{display:block;margin:10px auto;background:#1a1a1a;color:#ddd;
border:1px solid #3ad8c8;border-radius:10px;padding:6px 12px;font-size:13px;
box-shadow:0 0 5px rgba(0,255,213,.45)}
#logo{position:fixed;top:75px;left:16px;width:84px;height:84px;border-radius:50%;
background:url('dnx_logo.png') center/cover no-repeat;
box-shadow:0 0 24px rgba(255,215,0,.65),inset 0 0 18px rgba(255,215,0,.45);
animation:spin 12s linear infinite;z-index:999}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
main{margin-top:150px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center}
h1{color:var(--gold);font-size:2rem;text-shadow:0 0 28px rgba(255,215,0,.65);margin-top:18px}
.marquee{white-space:nowrap;overflow:hidden;box-sizing:border-box;width:90%;max-width:500px;margin:10px auto}
.marquee span{display:inline-block;padding-left:100%;animation:scroll 14s linear infinite;color:#00ffd5;opacity:.9;font-size:1rem}
@keyframes scroll{0%{transform:translate(0,0)}100%{transform:translate(-100%,0)}}
.card{background:rgba(0,0,0,.7);border:2px solid var(--gold);border-radius:16px;box-shadow:0 0 30px rgba(255,215,0,.28);padding:22px;width:min(95%,620px);margin:auto}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:10px;text-align:center}
.stat{background:rgba(255,255,255,.05);border:1px solid var(--neon);border-radius:10px;padding:10px}
.stat .label{font-size:13px;opacity:.8}
.stat .value{font-weight:800;color:var(--gold);word-break:break-word}
input{width:80%;padding:10px;margin:10px 0;border-radius:10px;border:1px solid var(--neon);background:#000;color:#00ffd5;text-align:center}
.action{border:none;border-radius:10px;padding:10px 16px;margin:5px;font-weight:800;cursor:pointer}
.btn{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000}
.gold{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000}
@keyframes goldBurst{0%{box-shadow:0 0 22px rgba(255,215,0,1);transform:scale(1.06)}100%{box-shadow:none;transform:scale(1)}}
.glowClaim{animation:goldBurst .9s ease}
footer{margin-top:14px;color:#888;font-size:14px;text-align:center}
</style>
</head>
<body>

<header>
  <div class="header-left"><button id="langToggle">EN</button></div>
  <div class="header-center"><button id="claimFreeTop">üéÅ Claim 500 DNX ‡∏ü‡∏£‡∏µ</button></div>
  <div class="header-right"><button id="connectBtn">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button></div>
</header>

<hr class="divider"/>
<button id="refreshSmall">üîÑ Refresh</button>
<div id="logo" aria-hidden="true"></div>

<main>
  <h1 id="title">üåæ DNX FARM ULTRA++</h1>
  <div class="marquee"><span id="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç Dynamix</span></div>
  <div class="card">
    <div class="stats">
      <div class="stat"><div class="label">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</div><div id="waddr" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">‡∏¢‡∏≠‡∏î DNX ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div id="bal" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Stake</div><div id="staked" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö</div><div id="pending" class="value">‚Äî</div></div>
    </div>
    <input id="amount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô DNX" />
    <div>
      <button id="deposit" class="action btn">üí∞ ‡∏ù‡∏≤‡∏Å (Deposit)</button>
      <button id="withdraw" class="action btn">üíé ‡∏ñ‡∏≠‡∏ô (Withdraw)</button>
    </div>
    <div>
      <button id="claim" class="action gold">üéÅ ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Claim)</button>
      <button id="buyDNX" class="action gold">üõí BUY DNX</button>
    </div>
    <footer>Powered by <b>DNX Finance</b> ¬© 2025</footer>
  </div>
</main>

<audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f8bcb2fca4.mp3" preload="auto"></audio>
<audio id="rewardSound" src="https://cdn.pixabay.com/download/audio/2022/03/23/audio_8a75c7c03b.mp3" preload="auto"></audio>

<script>
/* ===== CONFIG ===== */
const TOKEN  = "0x7DB860CC9D7f64Ed1B39de6621ebc94440C8dc62";
const CHEF   = "0xEa13c02F1c69668c2C9f873Fe6fdf44FDD3B0C3C";
const FAUCET = "0x0000000000000000000000000000000000000000";

/* ===== ABIs ===== */
const ABItoken = [
  "function balanceOf(address) view returns(uint256)",
  "function decimals() view returns(uint8)",
  "function allowance(address,address) view returns(uint256)",
  "function approve(address,uint256) returns(bool)"
];
const ABIchef = [
  "function deposit(uint256) external",
  "function withdraw(uint256) external",
  "function pendingReward(address) view returns(uint256)",
  "function stakes(address) view returns(uint256 amount,uint256 rewardDebt)"
];
const ABIfaucet = [
  "function claim() external",
  "function claimed(address) view returns(bool)"
];

/* ===== Helpers ===== */
const $ = id => document.getElementById(id);
const play = id => {const a=$(id);if(a){try{a.currentTime=0;a.play()}catch{}}};
function fmt(bn,dec=18){try{return parseFloat(ethers.utils.formatUnits(bn,dec)).toFixed(2)}catch{return "0.00"}}

let provider, signer, user, token, chef, faucet, dec=18;

/* ===== Connect Wallet ===== */
async function connect(){
  play("clickSound");
  if(!window.ethereum){alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏Å‡πà‡∏≠‡∏ô");return;}
  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts", []);
  signer = provider.getSigner();
  user = await signer.getAddress();
  token = new ethers.Contract(TOKEN, ABItoken, signer);
  chef  = new ethers.Contract(CHEF, ABIchef, signer);
  faucet = new ethers.Contract(FAUCET, ABIfaucet, signer);
  try{dec = await token.decimals();}catch{dec=18;}
  $("waddr").textContent = user.slice(0,6)+"..."+user.slice(-4);
  play("rewardSound");
  refreshData();
}
$("connectBtn").addEventListener("click",connect);

/* ===== Refresh Data ===== */
async function refreshData(){
  if(!user) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  try{
    const [bal, st, pending] = await Promise.all([
      token.balanceOf(user),
      chef.stakes(user),
      chef.pendingReward(user)
    ]);
    $("bal").textContent = fmt(bal,dec);
    $("staked").textContent = fmt(st.amount||0,dec);
    $("pending").textContent = fmt(pending,dec);
  }catch(e){console.error(e);}
}
$("refreshSmall").addEventListener("click",()=>{play("clickSound");refreshData();});

/* ===== Approve Helper ===== */
async function ensureApprove(amount){
  const allow = await token.allowance(user,CHEF);
  if(allow.gte(amount)) return;
  const tx = await token.approve(CHEF, ethers.constants.MaxUint256);
  await tx.wait();
}

/* ===== Deposit ===== */
async function onDeposit(){
  play("clickSound");
  if(!signer) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  const v=$("amount").value.trim(); if(!v) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô");
  const amt = ethers.utils.parseUnits(v,dec);
  await ensureApprove(amt);
  const tx = await chef.deposit(amt); await tx.wait();
  $("amount").value="";
  $("claim").classList.add("glowClaim");
  play("rewardSound");
  setTimeout(()=>{$("claim").classList.remove("glowClaim");},900);
  refreshData();
}

/* ===== Withdraw ===== */
async function onWithdraw(){
  play("clickSound");
  if(!signer) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  const v=$("amount").value.trim(); if(!v) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô");
  const amt = ethers.utils.parseUnits(v,dec);
  const tx = await chef.withdraw(amt); await tx.wait();
  $("amount").value="";
  $("claim").classList.add("glowClaim");
  play("rewardSound");
  setTimeout(()=>{$("claim").classList.remove("glowClaim");},900);
  refreshData();
}

/* ===== Claim Rewards ===== */
async function onClaim(){
  play("clickSound");
  if(!signer) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  const tx = await chef.deposit(0); await tx.wait();
  $("claim").classList.add("glowClaim");
  play("rewardSound");
  setTimeout(()=>{$("claim").classList.remove("glowClaim");},900);
  refreshData();
}

/* ===== BUY DNX ===== */
function buyDNX(){window.open("https://pancakeswap.finance/swap?outputCurrency="+TOKEN,"_blank");}

/* ===== Faucet (Top Button) ===== */
async function claimFreeTop(){
  play("clickSound");
  if(!signer) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  try{
    const fc = new ethers.Contract(FAUCET,ABIfaucet,signer);
    const isClaimed = await fc.claimed(user);
    if(isClaimed) return alert("‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß");
    const tx = await fc.claim(); await tx.wait();
    play("rewardSound");
  }catch(e){console.error(e);}
}

/* ===== Bind Buttons ===== */
$("deposit").addEventListener("click", onDeposit);
$("withdraw").addEventListener("click", onWithdraw);
$("claim").addEventListener("click", onClaim);
$("buyDNX").addEventListener("click", buyDNX);
$("claimFreeTop").addEventListener("click", claimFreeTop);
</script>
</body>
</html>

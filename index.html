<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üåæ DNX FARM ULTRA++</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root{--gold:#ffd700;--neon:#00ffd5}
*{box-sizing:border-box;margin:0;padding:0}
html,body{
  height:100%;overflow-x:hidden;
  font-family:"Poppins","Noto Sans Thai",sans-serif;
  background:radial-gradient(circle at top,#000 40%,#111 100%);
  color:#fff;text-align:center;
}
button{border:none;font-weight:700;cursor:pointer;transition:transform .12s ease}
button:hover{transform:translateY(-1px)}
header{
  position:fixed;top:0;left:0;right:0;z-index:20;
  display:grid;grid-template-columns:1fr auto;align-items:center;
  gap:8px;padding:10px 12px;
  background:linear-gradient(90deg,#111,#222,#111);
  border-bottom:2px solid var(--gold);
}
#langToggle{background:rgba(0,0,0,.6);border:1px solid var(--gold);color:var(--gold);
  padding:8px 14px;border-radius:12px}
#connectBtn{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000;
  padding:10px 18px;border-radius:18px}
.divider{margin-top:60px;border:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent)}
#logo{
  position:fixed;top:75px;left:16px;width:84px;height:84px;border-radius:50%;
  background:url('dnx_logo.png') center/cover no-repeat;
  box-shadow:0 0 24px rgba(255,215,0,.65);
  animation:spin 12s linear infinite;z-index:999;
}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
main{margin-top:160px;display:flex;flex-direction:column;align-items:center;}
h1{color:var(--gold);font-size:2rem;text-shadow:0 0 28px rgba(255,215,0,.65)}
.card{background:rgba(0,0,0,.7);border:2px solid var(--gold);border-radius:16px;
  box-shadow:0 0 30px rgba(255,215,0,.28);padding:22px;width:min(95%,620px);}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:10px}
.stat{background:rgba(255,255,255,.05);border:1px solid var(--neon);
  border-radius:10px;padding:10px}
.stat .label{font-size:13px;opacity:.8}
.stat .value{font-weight:800;color:var(--gold)}
input{width:80%;padding:10px;margin:10px 0;border-radius:10px;
  border:1px solid var(--neon);background:#000;color:#00ffd5;text-align:center}
.action{border:none;border-radius:10px;padding:10px 16px;margin:5px;font-weight:800;cursor:pointer}
.btn{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000}
.gold{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000}
footer{margin-top:14px;color:#888;font-size:14px}
</style>
</head>
<body>

<header>
  <button id="langToggle">EN</button>
  <button id="connectBtn">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>
</header>
<hr class="divider"/>

<div id="logo"></div>
<main>
  <h1>üåæ DNX FARM ULTRA++</h1>
  <div class="card">
    <div class="stats">
      <div class="stat"><div class="label" id="lblWallet">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</div><div id="waddr" class="value">‚Äî</div></div>
      <div class="stat"><div class="label" id="lblBal">‡∏¢‡∏≠‡∏î DNX ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div id="bal" class="value">‚Äî</div></div>
      <div class="stat"><div class="label" id="lblStake">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Stake</div><div id="staked" class="value">‚Äî</div></div>
      <div class="stat"><div class="label" id="lblReward">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö</div><div id="pending" class="value">‚Äî</div></div>
    </div>

    <input id="amount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô DNX" />
    <div><button id="deposit" class="action btn">üí∞ ‡∏ù‡∏≤‡∏Å (Deposit)</button><button id="withdraw" class="action btn">üíé ‡∏ñ‡∏≠‡∏ô (Withdraw)</button></div>
    <div><button id="claim" class="action gold">üéÅ ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Claim)</button><button id="buyDNX" class="action gold">üõí BUY DNX</button></div>
    <footer>Powered by <b>DNX Finance</b> ¬© 2025</footer>
  </div>
</main>

<script>
const TOKEN  = "0x7DB860CC9D7f64Ed1B39de6621ebc94440C8dc62"; // DNX Token
const CHEF   = "0xD71C62f34F976ed83526CC64653ade76Ed16BEf3"; // DNXStaking

const ABIchef = [
  "function deposit(uint256) external",
  "function withdraw(uint256) external",
  "function claimReward() external",
  "function pendingReward(address) view returns(uint256)",
  "function stakes(address) view returns(uint256 amount,uint256 lastUpdated)"
];
const ABItoken = [
  "function balanceOf(address) view returns(uint256)",
  "function decimals() view returns(uint8)",
  "function allowance(address,address) view returns(uint256)",
  "function approve(address,uint256) returns(bool)"
];

const $=id=>document.getElementById(id);
function fmt(bn,dec=18){try{return parseFloat(ethers.utils.formatUnits(bn,dec)).toFixed(2)}catch{return"0.00"}}

let provider, signer, user, token, chef, dec=18;

async function connect(){
  if(typeof window.ethereum==="undefined"){alert("‚ö†Ô∏è MetaMask not found");return;}
  const accounts=await ethereum.request({method:"eth_requestAccounts"});
  user=accounts[0];
  provider=new ethers.providers.Web3Provider(window.ethereum);
  signer=provider.getSigner();
  token=new ethers.Contract(TOKEN,ABItoken,signer);
  chef=new ethers.Contract(CHEF,ABIchef,signer);
  dec=await token.decimals();
  $("waddr").textContent=user.slice(0,6)+"..."+user.slice(-4);
  refreshData();
}

async function refreshData(){
  if(!user)return;
  const rt=new ethers.Contract(TOKEN,ABItoken,provider);
  const rc=new ethers.Contract(CHEF,ABIchef,provider);
  const [bal,stakeInfo,pending]=await Promise.all([
    rt.balanceOf(user),rc.stakes(user),rc.pendingReward(user)
  ]);
  $("bal").textContent=fmt(bal,dec);
  $("staked").textContent=fmt(stakeInfo.amount||0,dec);
  $("pending").textContent=fmt(pending,dec);
}

async function ensureApprove(amount){
  const allow=await token.allowance(user,CHEF);
  if(allow.gte(amount))return;
  const tx=await token.approve(CHEF,ethers.constants.MaxUint256);
  await tx.wait();
}

async function deposit(){
  const v=$("amount").value.trim();if(!v)return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô");
  const amt=ethers.utils.parseUnits(v,dec);
  await ensureApprove(amt);
  const tx=await chef.deposit(amt);await tx.wait();
  alert("‚úÖ ‡∏ù‡∏≤‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");$("amount").value="";refreshData();
}

async function withdraw(){
  const v=$("amount").value.trim();if(!v)return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô");
  const amt=ethers.utils.parseUnits(v,dec);
  const tx=await chef.withdraw(amt);await tx.wait();
  alert("‚úÖ ‡∏ñ‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");$("amount").value="";refreshData();
}

async function claimReward(){
  const tx=await chef.claimReward();await tx.wait();
  alert("üéÅ ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");refreshData();
}

function buyDNX(){
  window.open("https://pancakeswap.finance/swap?outputCurrency="+TOKEN,"_blank");
}

document.getElementById("connectBtn").onclick=connect;
document.getElementById("deposit").onclick=deposit;
document.getElementById("withdraw").onclick=withdraw;
document.getElementById("claim").onclick=claimReward;
document.getElementById("buyDNX").onclick=buyDNX;
</script>
</body>
</html>

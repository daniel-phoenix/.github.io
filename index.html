<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üåæ DNX STAKING ULTRA++ (iPad Debug)</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root{--gold:#ffd700;--neon:#00ffd5}
body{font-family:"Poppins","Noto Sans Thai",sans-serif;background:#000;color:#fff;text-align:center;padding:20px}
button{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000;border:none;padding:10px 20px;border-radius:10px;font-weight:700;cursor:pointer}
#log{margin-top:20px;text-align:left;background:#111;border:1px solid var(--gold);padding:10px;border-radius:10px;font-size:14px;max-height:300px;overflow:auto}
</style>
</head>
<body>

<h1>üåæ DNX STAKING ULTRA++</h1>
<p>‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö iPad / MetaMask Browser</p>
<button id="connectBtn">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>

<div id="log">[LOG]</div>

<script>
const TOKEN="0x7DB860CC9D7f64Ed1B39de6621ebc94440C8dc62";
const STAKING="0xEa13c02F1c69668c2C9f873Fe6fdf44FDD3B0C3C";

const ABItoken=[
 "function balanceOf(address) view returns(uint256)",
 "function decimals() view returns(uint8)"
];
const ABIstaking=[
 "function userInfo(address) view returns(uint256 amount,uint256 rewardDebt)",
 "function pendingReward(address) view returns(uint256)"
];

const log=(msg)=>{document.getElementById("log").innerHTML+=`<div>üü¢ ${msg}</div>`;};
const err=(msg)=>{document.getElementById("log").innerHTML+=`<div style='color:#f66'>‚ö†Ô∏è ${msg}</div>`;};
const fmt=(bn,dec=18)=>{try{return parseFloat(ethers.utils.formatUnits(bn,dec)).toFixed(4)}catch{return "0"}};

let provider,signer,user,token,staking,dec=18;

document.getElementById("connectBtn").onclick=async()=>{
 try{
   log("‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1Ô∏è‚É£: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö MetaMask...");
   if(!window.ethereum){err("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö MetaMask Browser");return;}
   log("‚úÖ ‡∏û‡∏ö MetaMask ‡πÅ‡∏•‡πâ‡∏ß!");

   const acc=await ethereum.request({method:"eth_requestAccounts"});
   user=acc[0];
   log("‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2Ô∏è‚É£: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‚Üí "+user);

   provider=new ethers.providers.Web3Provider(window.ethereum);
   signer=provider.getSigner();

   log("‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3Ô∏è‚É£: ‡∏™‡∏£‡πâ‡∏≤‡∏á instance ‡∏™‡∏±‡∏ç‡∏ç‡∏≤...");
   token=new ethers.Contract(TOKEN,ABItoken,signer);
   staking=new ethers.Contract(STAKING,ABIstaking,signer);
   dec=await token.decimals();
   log("‚úÖ ‡πÇ‡∏´‡∏•‡∏î decimals ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: "+dec);

   log("‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4Ô∏è‚É£: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å blockchain...");
   const [bal,info,pending]=await Promise.all([
     token.balanceOf(user),
     staking.userInfo(user),
     staking.pendingReward(user)
   ]);

   log("üí∞ ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: "+fmt(bal,dec));
   log("üì¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô stake: "+fmt(info.amount,dec));
   log("üéÅ ‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö: "+fmt(pending,dec));

   log("‚úÖ ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô!");
 }catch(e){
   err("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: "+(e.message||e));
 }
};
</script>
</body>
</html>

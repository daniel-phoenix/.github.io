<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>üåæ DNX FARM ULTRA++</title>

<style>
:root{--gold:#ffd700;--neon:#00ffd5;--success:#00ff99;--error:#ff4d4d;--info:#00ccff}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;overflow-x:hidden;}
body{
  background: radial-gradient(circle at center,#000 40%,#111 100%);
  color:#fff;font-family:"Poppins",sans-serif;text-align:center;
  display:flex;flex-direction:column;align-items:center;
  justify-content:flex-start;min-height:100vh;overflow:hidden;
}
header{
  width:100%;background:linear-gradient(90deg,#111,#222,#111);
  border-bottom:2px solid var(--gold);
  padding:10px 20px;position:fixed;top:0;left:0;z-index:10;
  display:flex;gap:10px;justify-content:flex-end;align-items:center;
  box-shadow:0 0 20px rgba(255,215,0,.4);
}
#connectBtn{
  background:linear-gradient(90deg,#ffd700,#ff9d00);
  border:none;color:#000;font-weight:bold;padding:10px 18px;
  border-radius:20px;cursor:pointer;animation:glow 2s infinite alternate;
}
@keyframes glow{from{box-shadow:0 0 10px rgba(255,215,0,.4);}to{box-shadow:0 0 25px rgba(255,215,0,1);}}
#langToggle{
  background:rgba(0,0,0,.6);border:1px solid var(--gold);
  color:var(--gold);font-weight:bold;padding:8px 12px;
  border-radius:12px;cursor:pointer;
}
#logo{
  position:fixed;top:70px;left:25px;width:90px;height:90px;
  border-radius:50%;background:url('dnx_logo.png') center/cover no-repeat;
  box-shadow:0 0 20px rgba(255,215,0,0.7),inset 0 0 25px rgba(255,215,0,0.6);
  animation:spin 12s linear infinite;z-index:10;
}
@keyframes spin{from{transform:rotate(0);}to{transform:rotate(360deg);}}
h1{margin-top:160px;color:var(--gold);font-size:2em;text-shadow:0 0 30px rgba(255,215,0,.7);}
p{opacity:.9;margin:10px 0 25px;}
.card{
  background:rgba(0,0,0,.7);border:2px solid var(--gold);border-radius:16px;
  box-shadow:0 0 30px rgba(255,215,0,.3);padding:25px;width:min(95%,600px);z-index:2;
}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:10px;}
.stat{background:rgba(255,255,255,.05);border:1px solid var(--neon);border-radius:10px;padding:10px;}
.stat .label{font-size:14px;opacity:.8}.stat .value{font-weight:bold;color:var(--gold);}
#pendingUSD{font-size:13px;color:#aaa;margin-top:2px;}
input{
  width:80%;padding:10px;margin:10px 0;border-radius:10px;
  border:1px solid var(--neon);background:#000;color:#00ffd5;text-align:center;
}
button{border:none;border-radius:10px;padding:10px 18px;margin:5px;font-weight:bold;cursor:pointer;}
.btn{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000;}
.gold{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000;}
button:hover{transform:scale(1.05);}
footer{margin-top:20px;color:#888;font-size:14px;}
#claimFree{background:linear-gradient(90deg,#00c6ff,#0072ff);color:#fff;border:none;padding:10px 25px;border-radius:20px;cursor:pointer;font-weight:bold;margin-top:10px;}
#claimFree.claimed{background:gray;cursor:not-allowed;}
#faucetInfo{font-size:13px;color:#ccc;margin-top:5px;}
#buyBtn{background:linear-gradient(90deg,#ff9d00,#ff5900);color:#000;border:none;padding:10px 25px;border-radius:20px;cursor:pointer;font-weight:bold;margin-top:10px;}
/* Toast: top-right */
.toast-container{
  position:fixed;top:20px;right:20px;display:flex;flex-direction:column;gap:10px;z-index:9999;
}
.toast{
  padding:12px 16px;border-radius:12px;font-weight:600;
  box-shadow:0 8px 28px rgba(0,0,0,0.55);backdrop-filter: blur(6px);
  animation:fadeIn 0.25s ease,fadeOut 0.35s ease 3.5s forwards;
}
.toast.success{background:rgba(0,255,153,0.12);border:1px solid var(--success);color:var(--success);}
.toast.error{background:rgba(255,77,77,0.12);border:1px solid var(--error);color:var(--error);}
.toast.info{background:rgba(0,204,255,0.12);border:1px solid var(--info);color:var(--info);}
@keyframes fadeIn{from{opacity:0;transform:translateY(-8px);}to{opacity:1;transform:translateY(0);}}
@keyframes fadeOut{from{opacity:1;}to{opacity:0;transform:translateY(-8px);}}
</style>
</head>

<body>
<header>
  <button id="langToggle">EN</button>
  <button id="connectBtn">üîó Connect Wallet</button>
</header>

<div id="logo"></div>

<h1 id="title">üåæ DNX FARM ULTRA++</h1>
<p id="subtitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç Dynamix</p>

<div class="card">
  <div class="stats">
    <div class="stat"><div class="label" id="lblWallet">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</div><div id="waddr" class="value">‚Äî</div></div>
    <div class="stat"><div class="label" id="lblBal">‡∏¢‡∏≠‡∏î DNX ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div id="bal" class="value">‚Äî</div></div>
    <div class="stat"><div class="label" id="lblStake">Stake</div><div id="staked" class="value">‚Äî</div></div>
    <div class="stat">
      <div class="label" id="lblReward">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö</div>
      <div id="pending" class="value">‚Äî</div>
      <div id="pendingUSD">‚âà ‚Äî USD</div>
    </div>
  </div>

  <input id="amount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô DNX" />
  <div>
    <button id="deposit" class="btn">üí∞ Deposit</button>
    <button id="withdraw" class="btn">üíé Withdraw</button>
    <button id="claim" class="btn gold">üéÅ Claim</button>
    <button id="refresh" class="btn">üîÑ Refresh</button>
  </div>

  <hr style="margin:15px 0;border-color:#333;">
  <button id="claimFree">üéÅ Claim DNX ‡∏ü‡∏£‡∏µ</button>
  <div id="faucetInfo">‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‚Äî DNX ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡∏Å</div>
  <button id="buyBtn">üõí Buy DNX on PancakeSwap</button>

  <footer>Powered by <b>DNX Finance</b> ¬© 2025</footer>
</div>

<!-- Toast container + Sounds -->
<div class="toast-container" id="toastContainer"></div>
<audio id="sndSuccess" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-bonus-alert-767.mp3" preload="auto"></audio>
<audio id="sndError"   src="https://assets.mixkit.co/sfx/preview/mixkit-electric-alert-notification-2567.mp3" preload="auto"></audio>
<audio id="sndInfo"    src="https://assets.mixkit.co/sfx/preview/mixkit-interface-click-1126.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>

<script>
window.addEventListener("load",()=>{
  // ===== Contract Addresses (‡πÅ‡∏Å‡πâ FAUCET ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô) =====
  const TOKEN  = "0x7DB860CC9D7f64Ed1B39de6621ebc94440C8dc62";
  const CHEF   = "0xEa13c02F1c69668c2C9f873Fe6fdf44FDD3B0C3C";
  const FAUCET = "0x0000000000000000000000000000000000000000"; // üëà ‡πÉ‡∏™‡πà address Faucet ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì deploy

  // ===== ABIs =====
  const ABIchef = [
    "function deposit(uint256) external",
    "function withdraw(uint256) external",
    "function pendingReward(address) view returns(uint256)",
    "function stakes(address) view returns(uint256 amount,uint256 rewardDebt)"
  ];
  const ABItoken = [
    "function balanceOf(address) view returns(uint256)",
    "function decimals() view returns(uint8)",
    "function allowance(address,address) view returns(uint256)",
    "function approve(address,uint256) returns(bool)"
  ];
  const ABIfaucet = [
    "function claim() external",
    "function claimed(address) view returns(bool)",
    "function dnxToken() view returns(address)",
    "function claimAmount() view returns(uint256)"
  ];

  // ===== State =====
  let provider,signer,user,chef,token,faucet,dec=18,priceUSD=0;
  const $=id=>document.getElementById(id);

  // ===== Toast + Sound =====
  const snd = {
    success: ()=>{const a=$("sndSuccess"); a.currentTime=0; a.play().catch(()=>{});},
    error:   ()=>{const a=$("sndError");   a.currentTime=0; a.play().catch(()=>{});},
    info:    ()=>{const a=$("sndInfo");    a.currentTime=0; a.play().catch(()=>{});}
  };
  function toast(msg,type="info"){
    const box=document.createElement("div");
    box.className=`toast ${type}`;
    box.textContent=msg;
    $("toastContainer").appendChild(box);
    // play sound
    (snd[type]||snd.info)();
    setTimeout(()=>box.remove(),3800);
  }

  // ===== Language Toggle =====
  let lang="TH";
  const t={
    TH:{connect:"üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤",wallet:"‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤",total:"‡∏¢‡∏≠‡∏î DNX ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",stake:"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Stake",
        reward:"‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö",placeholder:"‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô DNX",deposit:"üí∞ ‡∏ù‡∏≤‡∏Å (Deposit)",
        withdraw:"üíé ‡∏ñ‡∏≠‡∏ô (Withdraw)",claim:"üéÅ ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏• (Claim)",refresh:"üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä",
        subtitle:"‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç Dynamix",
        faucetBtn:"üéÅ Claim DNX ‡∏ü‡∏£‡∏µ", faucetLeft:(n,amt)=>`‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏à‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${n} ‡∏Ñ‡∏ô (${amt} DNX)`, buy:"üõí Buy DNX on PancakeSwap", toggle:"EN",
        got:"‚úÖ ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢"},
    EN:{connect:"üîó Connect Wallet",wallet:"Wallet",total:"Total DNX",stake:"Staked",
        reward:"Pending Reward",placeholder:"Enter DNX amount",deposit:"üí∞ Deposit",
        withdraw:"üíé Withdraw",claim:"üéÅ Claim",refresh:"üîÑ Refresh",
        subtitle:"Full farming system to earn Dynamix rewards",
        faucetBtn:"üéÅ Claim Free DNX", faucetLeft:(n,amt)=>`About ${n} users left (${amt} DNX)`, buy:"üõí Buy DNX on PancakeSwap", toggle:"TH",
        got:"‚úÖ Claimed"}
  };
  function applyLang(){
    const L=t[lang];
    $("connectBtn").textContent=L.connect;
    $("lblWallet").textContent=L.wallet;
    $("lblBal").textContent=L.total;
    $("lblStake").textContent=L.stake;
    $("lblReward").textContent=L.reward;
    $("amount").placeholder=L.placeholder;
    $("deposit").textContent=L.deposit;
    $("withdraw").textContent=L.withdraw;
    $("claim").textContent=L.claim;
    $("refresh").textContent=L.refresh;
    $("subtitle").textContent=L.subtitle;
    $("claimFree").textContent=L.faucetBtn;
    $("buyBtn").textContent=L.buy;
    $("langToggle").textContent=L.toggle;
  }
  $("langToggle").addEventListener("click",()=>{lang=lang==="TH"?"EN":"TH"; applyLang(); toast(lang==="TH"?"‡∏™‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ó‡∏¢‡πÅ‡∏•‡πâ‡∏ß":"Language switched to English","info");});
  applyLang();

  // ===== Connect Wallet =====
  async function connect(){
    if(!window.ethereum) return toast("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏Å‡πà‡∏≠‡∏ô","error");
    provider=new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts",[]);
    signer=provider.getSigner();
    user=await signer.getAddress();
    $("waddr").textContent=user.slice(0,6)+"..."+user.slice(-4);
    token=new ethers.Contract(TOKEN,ABItoken,signer);
    chef =new ethers.Contract(CHEF ,ABIchef ,signer);
    faucet=new ethers.Contract(FAUCET,ABIfaucet,signer);
    dec=await token.decimals().catch(()=>18);
    toast(lang==="TH"?"‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à":"Wallet connected","success");
    await refreshAll();
  }

  // ===== Refresh =====
  async function refreshAll(){
    if(!signer) return;
    try{
      const [bal,st,p]=await Promise.all([
        token.balanceOf(user),
        chef.stakes(user),
        chef.pendingReward(user)
      ]);
      $("bal").textContent=ethers.utils.formatUnits(bal,dec);
      $("staked").textContent=ethers.utils.formatUnits(st.amount,dec);
      $("pending").textContent=ethers.utils.formatUnits(p,dec);
      await updateFaucetInfo();
    }catch(e){ console.error(e); toast("Refresh failed","error"); }
  }

  // ===== Approve helper =====
  async function ensureApprove(a){
    const allow=await token.allowance(user,CHEF);
    if(allow.gte(a)) return;
    const tx=await token.approve(CHEF,ethers.constants.MaxUint256);
    await tx.wait();
  }

  // ===== Actions =====
  async function onDeposit(){
    try{
      const val=$("amount").value.trim();
      if(!val) return toast(lang==="TH"?"‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô":"Enter an amount","error");
      const amt=ethers.utils.parseUnits(val,dec);
      await ensureApprove(amt);
      const tx=await chef.deposit(amt); await tx.wait();
      toast(lang==="TH"?"‡∏ù‡∏≤‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à":"Deposit successful","success");
      $("amount").value=""; refreshAll();
    }catch(e){ console.error(e); toast(e?.data?.message||e?.message||"Deposit failed","error"); }
  }

  async function onWithdraw(){
    try{
      const val=$("amount").value.trim();
      if(!val) return toast(lang==="TH"?"‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô":"Enter an amount","error");
      const amt=ethers.utils.parseUnits(val,dec);
      const tx=await chef.withdraw(amt); await tx.wait();
      toast(lang==="TH"?"‡∏ñ‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à":"Withdraw successful","success");
      $("amount").value=""; refreshAll();
    }catch(e){ console.error(e); toast(e?.data?.message||e?.message||"Withdraw failed","error"); }
  }

  async function onClaim(){
    try{
      const tx=await chef.deposit(0); await tx.wait();
      toast(lang==="TH"?"‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à":"Claim successful","success");
      refreshAll();
    }catch(e){ console.error(e); toast(e?.data?.message||e?.message||"Claim failed","error"); }
  }

  // Faucet Claim
  async function onClaimFree(){
    if(!signer) return toast(lang==="TH"?"‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô":"Connect wallet first","error");
    try{
      const contract=new ethers.Contract(FAUCET,["function claim() external","function claimed(address) view returns(bool)"],signer);
      const isClaimed=await contract.claimed(user);
      if(isClaimed) return toast(lang==="TH"?"‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß":"Already claimed","info");
      const tx=await contract.claim(); await tx.wait();
      $("claimFree").textContent=t[lang].got;
      $("claimFree").classList.add("claimed");
      toast(lang==="TH"?"‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö DNX ‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡πâ‡∏ß!":"Free DNX received!","success");
      updateFaucetInfo();
    }catch(e){ console.error(e); toast(e?.data?.message||e?.message||"Faucet claim failed","error"); }
  }

  async function updateFaucetInfo(){
    try{
      const f=new ethers.Contract(FAUCET,ABIfaucet,provider);
      const tokenAddr=await f.dnxToken();
      const faucetToken=new ethers.Contract(tokenAddr,ABItoken,provider);
      const [bal,amt]=await Promise.all([faucetToken.balanceOf(FAUCET), f.claimAmount()]);
      const remain = amt.gt(0) ? bal.div(amt).toString() : "‚Äî";
      const balFmt = ethers.utils.formatUnits(bal,dec);
      $("faucetInfo").textContent=t[lang].faucetLeft(remain, balFmt);
    }catch{ $("faucetInfo").textContent="‚Äî"; }
  }

  // Buy DNX
  function onBuy(){ window.open("https://pancakeswap.finance/swap?outputCurrency="+TOKEN,"_blank"); }

  // Bind
  $("connectBtn").onclick=connect;
  $("refresh").onclick=refreshAll;
  $("deposit").onclick=onDeposit;
  $("withdraw").onclick=onWithdraw;
  $("claim").onclick=onClaim;
  $("claimFree").onclick=onClaimFree;
  $("buyBtn").onclick=onBuy;
});
</script>
</body>
</html>

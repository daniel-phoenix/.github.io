<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üåæ DNX FARM ULTRA++</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<style>
:root{--gold:#ffd700;--neon:#00ffd5}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:"Poppins","Noto Sans Thai",sans-serif;
  background:radial-gradient(circle at top,#000 40%,#111 100%);
  color:#fff;text-align:center;overflow-x:hidden;
}
header{
  position:fixed;top:0;left:0;right:0;z-index:10;
  background:linear-gradient(90deg,#111,#222,#111);
  border-bottom:2px solid var(--gold);
  display:flex;justify-content:space-between;align-items:center;
  padding:10px 20px;box-shadow:0 0 20px rgba(255,215,0,.4);
}
#langToggle,#connectBtn,#claimFreeTop{
  border:none;border-radius:12px;font-weight:700;cursor:pointer;
}
#langToggle{background:rgba(0,0,0,.5);border:1px solid var(--gold);color:var(--gold);padding:8px 14px}
#claimFreeTop{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000;padding:8px 14px;border-radius:16px}
#connectBtn{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000;padding:10px 20px;border-radius:16px}
#refreshSmall{margin-top:60px;border:1px solid var(--neon);border-radius:10px;padding:5px 10px;font-size:13px;background:#111;color:#0ff}
#logo{
  position:fixed;top:80px;left:15px;width:80px;height:80px;
  background:url('dnx_logo.png') center/cover no-repeat;border-radius:50%;
  box-shadow:0 0 20px rgba(255,215,0,.6),inset 0 0 20px rgba(255,215,0,.4);
  animation:spin 12s linear infinite;z-index:5;
}
@keyframes spin{to{transform:rotate(360deg)}}
main{margin-top:150px;display:flex;flex-direction:column;align-items:center}
h1{color:var(--gold);font-size:2rem;text-shadow:0 0 25px var(--gold)}
.marquee{white-space:nowrap;overflow:hidden;width:90%;max-width:480px;margin:10px auto}
.marquee span{display:inline-block;padding-left:100%;animation:scroll 15s linear infinite;color:#00ffd5}
@keyframes scroll{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}
.card{
  background:rgba(0,0,0,.7);border:2px solid var(--gold);border-radius:16px;
  box-shadow:0 0 30px rgba(255,215,0,.3);padding:20px;width:min(95%,600px);
}
.stats{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:10px}
.stat{background:rgba(255,255,255,.05);border:1px solid var(--neon);border-radius:10px;padding:10px}
.stat .label{font-size:13px;opacity:.8}
.stat .value{font-weight:800;color:var(--gold)}
input{width:80%;padding:10px;margin:10px 0;border:1px solid var(--neon);
  border-radius:10px;background:#000;color:#00ffd5;text-align:center}
button.action{border:none;border-radius:10px;padding:10px 16px;margin:5px;font-weight:700;cursor:pointer}
.btn{background:linear-gradient(90deg,#00ffd5,#00c8a7);color:#000}
.gold{background:linear-gradient(90deg,#ffd700,#ff9d00);color:#000}
.glowClaim{animation:claimFx .9s ease}
@keyframes claimFx{0%{box-shadow:0 0 22px var(--gold);transform:scale(1.05)}100%{box-shadow:none;transform:scale(1)}}
footer{margin-top:14px;color:#aaa;font-size:14px}
</style>
</head>
<body>

<header>
  <button id="langToggle">EN</button>
  <button id="claimFreeTop">üéÅ Claim 500 DNX ‡∏ü‡∏£‡∏µ</button>
  <button id="connectBtn">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</button>
</header>

<button id="refreshSmall">üîÑ Refresh</button>
<div id="logo"></div>

<main>
  <h1>üåæ DNX FARM ULTRA++</h1>
  <div class="marquee"><span>‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏à‡∏≤‡∏Å‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç Dynamix</span></div>

  <div class="card">
    <div class="stats">
      <div class="stat"><div class="label">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤</div><div id="waddr" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">‡∏¢‡∏≠‡∏î DNX ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div id="bal" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">Stake</div><div id="staked" class="value">‚Äî</div></div>
      <div class="stat"><div class="label">‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏Ñ‡πâ‡∏≤‡∏á‡∏£‡∏±‡∏ö</div><div id="pending" class="value">‚Äî</div></div>
    </div>

    <input id="amount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô DNX" />
    <div>
      <button id="deposit" class="action btn">üí∞ ‡∏ù‡∏≤‡∏Å</button>
      <button id="withdraw" class="action btn">üíé ‡∏ñ‡∏≠‡∏ô</button>
    </div>
    <div>
      <button id="claim" class="action gold">üéÅ ‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</button>
      <button id="buyDNX" class="action gold">üõí BUY DNX</button>
    </div>
    <footer>Powered by <b>DNX Finance</b> ¬© 2025</footer>
  </div>
</main>

<audio id="clickSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_f8bcb2fca4.mp3?filename=click-124467.mp3" preload="auto"></audio>
<audio id="rewardSound" src="https://cdn.pixabay.com/download/audio/2022/03/23/audio_8a75c7c03b.mp3?filename=coin-bell-glow-115372.mp3" preload="auto"></audio>

<script>
const TOKEN="0x7DB860CC9D7f64Ed1B39de6621ebc94440C8dc62";
const CHEF ="0xEa13c02F1c69668c2C9f873Fe6fdf44FDD3B0C3C";

const ABItoken=[
  "function balanceOf(address) view returns(uint256)",
  "function decimals() view returns(uint8)",
  "function allowance(address,address) view returns(uint256)",
  "function approve(address,uint256) returns(bool)"
];

// ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô contract
let FN_DEPOSIT="deposit",FN_WITHDRAW="withdraw",FN_PENDING="pendingReward",FN_STAKEVIEW="stakes";

const $=id=>document.getElementById(id);
const play=id=>{const a=$(id);if(a){try{a.currentTime=0;a.play()}catch{}}};
function fmt(bn,dec=18){try{return parseFloat(ethers.utils.formatUnits(bn,dec)).toFixed(2)}catch{return"0.00"}}

let provider,signer,user,token,chef,dec=18;

/* ==== ‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ==== */
async function autoDetectABI(){
  const testABI=[
    "function deposit(uint256) external",
    "function stake(uint256) external",
    "function enterStaking(uint256) external",
    "function withdraw(uint256) external",
    "function unstake(uint256) external",
    "function claimReward() external",
    "function harvest() external",
    "function pendingReward(address) view returns(uint256)",
    "function pendingRewards(address) view returns(uint256)",
    "function userInfo(address) view returns(uint256 amount,uint256 rewardDebt)",
    "function stakes(address) view returns(uint256 amount,uint256 rewardDebt)"
  ];
  let testContract=new ethers.Contract(CHEF,testABI,provider);
  try{
    for(let fn of testABI){
      const name=fn.split("(")[0].split(" ").pop();
      try{await testContract.callStatic[name](user).catch(()=>{});}catch{}
      if(name.includes("pendingReward"))FN_PENDING=name;
      if(name.includes("userInfo")||name.includes("stakes"))FN_STAKEVIEW=name;
      if(name.includes("deposit")||name.includes("stake")||name.includes("enter"))FN_DEPOSIT=name;
      if(name.includes("withdraw")||name.includes("unstake"))FN_WITHDRAW=name;
    }
    console.log("‚úÖ AutoDetect ABI",FN_DEPOSIT,FN_WITHDRAW,FN_PENDING);
  }catch(e){console.warn("AutoDetect failed",e);}
}

/* ==== ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤ ==== */
async function connect(){
  play("clickSound");
  if(!window.ethereum)return alert("‚ö†Ô∏è ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MetaMask ‡∏Å‡πà‡∏≠‡∏ô");
  try{
    provider=new ethers.providers.Web3Provider(window.ethereum);
    await provider.send("eth_requestAccounts",[]);
    signer=provider.getSigner();
    user=await signer.getAddress();
    token=new ethers.Contract(TOKEN,ABItoken,signer);
    chef=new ethers.Contract(CHEF,[],signer);
    dec=await token.decimals().catch(()=>18);
    $("waddr").textContent=user.slice(0,6)+"..."+user.slice(-4);
    play("rewardSound");
    await autoDetectABI();
    await refreshData();
  }catch(e){console.error(e);alert("‚ùå "+e.message);}
}
$("connectBtn").onclick=connect;

/* ==== ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ==== */
async function refreshData(){
  if(!provider||!user)return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Å‡πà‡∏≠‡∏ô");
  try{
    const t=new ethers.Contract(TOKEN,ABItoken,provider);
    const bal=await t.balanceOf(user);
    const c=new ethers.Contract(CHEF,[`function ${FN_STAKEVIEW}(address) view returns(uint256 amount,uint256 rewardDebt)`,`function ${FN_PENDING}(address) view returns(uint256)`],provider);
    const [stake,pending]=await Promise.all([
      c[FN_STAKEVIEW](user),
      c[FN_PENDING](user)
    ]);
    $("bal").textContent=fmt(bal,dec);
    $("staked").textContent=fmt(stake.amount||0,dec);
    $("pending").textContent=fmt(pending,dec);
  }catch(e){console.error(e);}
}
$("refreshSmall").onclick=()=>{play("clickSound");refreshData();};

/* ==== Action ‡∏õ‡∏∏‡πà‡∏° ==== */
async function ensureApprove(amount){
  const allow=await token.allowance(user,CHEF);
  if(allow.gte(amount))return;
  const tx=await token.approve(CHEF,ethers.constants.MaxUint256);
  await tx.wait();
}
async function onDeposit(){
  play("clickSound");
  const v=$("amount").value.trim();if(!v)return;
  const amt=ethers.utils.parseUnits(v,dec);
  await ensureApprove(amt);
  const c=new ethers.Contract(CHEF,[`function ${FN_DEPOSIT}(uint256)`],signer);
  const tx=await c[FN_DEPOSIT](amt);await tx.wait();
  $("amount").value="";refreshData();
}
async function onWithdraw(){
  play("clickSound");
  const v=$("amount").value.trim();if(!v)return;
  const amt=ethers.utils.parseUnits(v,dec);
  const c=new ethers.Contract(CHEF,[`function ${FN_WITHDRAW}(uint256)`],signer);
  const tx=await c[FN_WITHDRAW](amt);await tx.wait();
  $("amount").value="";refreshData();
}
async function onClaim(){
  play("clickSound");
  const c=new ethers.Contract(CHEF,[`function ${FN_DEPOSIT}(uint256)`],signer);
  const tx=await c ;await tx.wait();
  $("claim").classList.add("glowClaim");
  play("rewardSound");
  setTimeout(()=>{$("claim").classList.remove("glowClaim");},900);
  refreshData();
}
function buyDNX(){window.open("https://pancakeswap.finance/swap?outputCurrency="+TOKEN,"_blank");}

$("deposit").onclick=onDeposit;
$("withdraw").onclick=onWithdraw;
$("claim").onclick=onClaim;
$("buyDNX").onclick=buyDNX;
</script>
</body>
</html>
